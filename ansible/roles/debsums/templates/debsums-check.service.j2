[Unit]
Description=Debsums Package Integrity Check
Documentation=man:debsums(1)
After=local-fs.target

[Service]
Type=oneshot
User=root
Group=root
ExecStart=/usr/local/bin/debsums-check.sh
StandardOutput=journal
StandardError=journal

# Security settings
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/log/debsums {{ debsums_report_dir | default('/var/lib/debsums/reports') }}
PrivateTmp=true
ProtectKernelTunables=true
ProtectKernelModules=true
ProtectControlGroups=true
RestrictRealtime=true
RestrictSUIDSGID=true

# Resource limits for Raspberry Pi
MemoryLimit={{ debsums_memory_limit | default('512M') }}
TimeoutStartSec={{ debsums_timeout | default('1800') }}
Nice={{ debsums_nice_level | default('10') }}

[Install]
WantedBy=multi-user.target